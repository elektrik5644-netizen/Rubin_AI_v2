#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–ü–ª–∞–Ω —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö Rubin AI –¥–æ 200+ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
"""

import sqlite3
import json
from datetime import datetime, timedelta
from typing import List, Dict, Any
import os

class DatabaseExpansionPlanner:
    """–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö"""
    
    def __init__(self, db_path: str = "rubin_ai_v2.db"):
        self.db_path = db_path
        self.connection = None
        self.connect_database()
    
    def connect_database(self):
        """–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö"""
        try:
            self.connection = sqlite3.connect(self.db_path)
            self.connection.execute("PRAGMA foreign_keys = ON")
            print("‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ")
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î: {e}")
            raise
    
    def analyze_current_state(self) -> Dict[str, Any]:
        """–ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö"""
        try:
            cursor = self.connection.cursor()
            
            # –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            cursor.execute("SELECT COUNT(*) FROM documents")
            total_docs = cursor.fetchone()[0]
            
            # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
            cursor.execute("""
                SELECT category, COUNT(*) as count
                FROM documents 
                GROUP BY category
                ORDER BY count DESC
            """)
            categories = cursor.fetchall()
            
            # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —É—Ä–æ–≤–Ω—è–º —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
            cursor.execute("""
                SELECT difficulty_level, COUNT(*) as count
                FROM documents 
                WHERE difficulty_level IS NOT NULL
                GROUP BY difficulty_level
                ORDER BY count DESC
            """)
            difficulties = cursor.fetchall()
            
            # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏–Ω–æ–Ω–∏–º–æ–≤
            cursor.execute("SELECT COUNT(*) FROM technical_synonyms")
            total_synonyms = cursor.fetchone()[0]
            
            # –†–∞–∑–º–µ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
            db_size = os.path.getsize(self.db_path)
            
            analysis = {
                'total_documents': total_docs,
                'total_synonyms': total_synonyms,
                'database_size_mb': round(db_size / (1024 * 1024), 2),
                'categories': [{'name': cat[0], 'count': cat[1]} for cat in categories],
                'difficulty_levels': [{'level': diff[0], 'count': diff[1]} for diff in difficulties],
                'analysis_date': datetime.now().isoformat()
            }
            
            return analysis
            
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞: {e}")
            return {}
    
    def create_expansion_plan(self, target_documents: int = 200) -> Dict[str, Any]:
        """–°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞–Ω–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö"""
        try:
            current_state = self.analyze_current_state()
            current_docs = current_state.get('total_documents', 0)
            
            documents_needed = target_documents - current_docs
            
            if documents_needed <= 0:
                print(f"‚úÖ –¶–µ–ª—å —É–∂–µ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞! –í –±–∞–∑–µ {current_docs} –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤")
                return {'status': 'goal_achieved', 'current_documents': current_docs}
            
            # –ü–ª–∞–Ω —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
            expansion_plan = {
                'target_documents': target_documents,
                'current_documents': current_docs,
                'documents_needed': documents_needed,
                'expansion_categories': [
                    {
                        'category': '–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è',
                        'current_count': self._get_category_count('–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è'),
                        'target_count': 50,
                        'documents_to_add': 0,
                        'priority': '–≤—ã—Å–æ–∫–∏–π',
                        'topics': [
                            '–ü–ò–î-—Ä–µ–≥—É–ª—è—Ç–æ—Ä—ã (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ)',
                            'SCADA —Å–∏—Å—Ç–µ–º—ã',
                            '–ü–õ–ö –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ',
                            '–ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–µ —Å–µ—Ç–∏',
                            '–°–∏—Å—Ç–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏',
                            '–ê–≤–∞—Ä–∏–π–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã',
                            '–†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ',
                            '–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è'
                        ]
                    },
                    {
                        'category': '—ç–ª–µ–∫—Ç—Ä–æ—Ç–µ—Ö–Ω–∏–∫–∞',
                        'current_count': self._get_category_count('—ç–ª–µ–∫—Ç—Ä–æ—Ç–µ—Ö–Ω–∏–∫–∞'),
                        'target_count': 40,
                        'documents_to_add': 0,
                        'priority': '–≤—ã—Å–æ–∫–∏–π',
                        'topics': [
                            '–≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–µ –º–∞—à–∏–Ω—ã',
                            '–°–∏–ª–æ–≤—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª–∏',
                            '–≠–ª–µ–∫—Ç—Ä–æ–ø—Ä–∏–≤–æ–¥—ã',
                            '–†–µ–ª–µ–π–Ω–∞—è –∑–∞—â–∏—Ç–∞',
                            '–≠–ª–µ–∫—Ç—Ä–æ–∏–∑–º–µ—Ä–µ–Ω–∏—è',
                            '–≠–ª–µ–∫—Ç—Ä–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å',
                            '–ö–∞–±–µ–ª—å–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã',
                            '–ó–∞–∑–µ–º–ª–µ–Ω–∏–µ –∏ –º–æ–ª–Ω–∏–µ–∑–∞—â–∏—Ç–∞'
                        ]
                    },
                    {
                        'category': '–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ',
                        'current_count': self._get_category_count('–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ'),
                        'target_count': 35,
                        'documents_to_add': 0,
                        'priority': '—Å—Ä–µ–¥–Ω–∏–π',
                        'topics': [
                            'Python –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏',
                            'C++ –¥–ª—è –≤—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã—Ö —Å–∏—Å—Ç–µ–º',
                            'JavaScript –¥–ª—è –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤',
                            'SQL –¥–ª—è –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö',
                            '–ê–ª–≥–æ—Ä–∏—Ç–º—ã –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö',
                            '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞',
                            '–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ',
                            '–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞'
                        ]
                    },
                    {
                        'category': '—Ä–∞–¥–∏–æ—Ç–µ—Ö–Ω–∏–∫–∞',
                        'current_count': self._get_category_count('—Ä–∞–¥–∏–æ—Ç–µ—Ö–Ω–∏–∫–∞'),
                        'target_count': 25,
                        'documents_to_add': 0,
                        'priority': '—Å—Ä–µ–¥–Ω–∏–π',
                        'topics': [
                            '–ê–Ω—Ç–µ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã',
                            '–†–∞–¥–∏–æ–ø–µ—Ä–µ–¥–∞—Ç—á–∏–∫–∏',
                            '–†–∞–¥–∏–æ–ø—Ä–∏–µ–º–Ω–∏–∫–∏',
                            '–ú–æ–¥—É–ª—è—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤',
                            '–¶–∏—Ñ—Ä–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤',
                            '–†–∞–¥–∏–æ–ª–æ–∫–∞—Ü–∏—è',
                            '–°–ø—É—Ç–Ω–∏–∫–æ–≤–∞—è —Å–≤—è–∑—å',
                            '–ë–µ—Å–ø—Ä–æ–≤–æ–¥–Ω—ã–µ —Å–µ—Ç–∏'
                        ]
                    },
                    {
                        'category': '–º–µ—Ö–∞–Ω–∏–∫–∞',
                        'current_count': self._get_category_count('–º–µ—Ö–∞–Ω–∏–∫–∞'),
                        'target_count': 20,
                        'documents_to_add': 0,
                        'priority': '—Å—Ä–µ–¥–Ω–∏–π',
                        'topics': [
                            '–î–µ—Ç–∞–ª–∏ –º–∞—à–∏–Ω',
                            '–ú–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏–µ –ø–µ—Ä–µ–¥–∞—á–∏',
                            '–ü–æ–¥—à–∏–ø–Ω–∏–∫–∏',
                            '–°–º–∞–∑–∫–∞ –∏ —Å–º–∞–∑–æ—á–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã',
                            '–í–∏–±—Ä–∞—Ü–∏—è –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞',
                            '–ú–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—ã—Ç–∞–Ω–∏—è',
                            '–ú–∞—Ç–µ—Ä–∏–∞–ª–æ–≤–µ–¥–µ–Ω–∏–µ',
                            '–ü—Ä–æ—á–Ω–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å'
                        ]
                    },
                    {
                        'category': '–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ_—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏',
                        'current_count': self._get_category_count('–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ_—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏'),
                        'target_count': 20,
                        'documents_to_add': 0,
                        'priority': '—Å—Ä–µ–¥–Ω–∏–π',
                        'topics': [
                            '–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö',
                            '–°–µ—Ç–µ–≤—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏',
                            '–ö–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å',
                            '–û–±–ª–∞—á–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è',
                            '–ë–æ–ª—å—à–∏–µ –¥–∞–Ω–Ω—ã–µ',
                            '–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç',
                            '–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ',
                            '–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –≤–µ—â–µ–π'
                        ]
                    },
                    {
                        'category': '–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å',
                        'current_count': self._get_category_count('–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å'),
                        'target_count': 10,
                        'documents_to_add': 0,
                        'priority': '–≤—ã—Å–æ–∫–∏–π',
                        'topics': [
                            '–ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å',
                            '–≠–ª–µ–∫—Ç—Ä–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å',
                            '–ü–æ–∂–∞—Ä–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å',
                            '–û—Ö—Ä–∞–Ω–∞ —Ç—Ä—É–¥–∞',
                            '–≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å',
                            '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å',
                            '–ê–≤–∞—Ä–∏–π–Ω—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏',
                            '–≠–≤–∞–∫—É–∞—Ü–∏—è –∏ —Å–ø–∞—Å–µ–Ω–∏–µ'
                        ]
                    }
                ],
                'timeline': {
                    'phase_1': {
                        'duration': '1 –º–µ—Å—è—Ü',
                        'documents': 50,
                        'focus': '–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è, —ç–ª–µ–∫—Ç—Ä–æ—Ç–µ—Ö–Ω–∏–∫–∞'
                    },
                    'phase_2': {
                        'duration': '1 –º–µ—Å—è—Ü', 
                        'documents': 50,
                        'focus': '–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ä–∞–¥–∏–æ—Ç–µ—Ö–Ω–∏–∫–∞'
                    },
                    'phase_3': {
                        'duration': '1 –º–µ—Å—è—Ü',
                        'documents': 50,
                        'focus': '–º–µ—Ö–∞–Ω–∏–∫–∞, –ò–¢, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å'
                    }
                },
                'resources_needed': {
                    'expertise': [
                        '–ò–Ω–∂–µ–Ω–µ—Ä—ã –ø–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏',
                        '–≠–ª–µ–∫—Ç—Ä–æ—Ç–µ—Ö–Ω–∏–∫–∏',
                        '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—ã',
                        '–†–∞–¥–∏–æ–∏–Ω–∂–µ–Ω–µ—Ä—ã',
                        '–ú–µ—Ö–∞–Ω–∏–∫–∏',
                        'IT-—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã',
                        '–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏'
                    ],
                    'tools': [
                        '–°–∏—Å—Ç–µ–º—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–æ–±–æ—Ä–æ—Ç–∞',
                        '–†–µ–¥–∞–∫—Ç–æ—Ä—ã —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏',
                        '–°–∏—Å—Ç–µ–º—ã –∫–æ–Ω—Ç—Ä–æ–ª—è –≤–µ—Ä—Å–∏–π',
                        '–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–∏–∞–≥—Ä–∞–º–º',
                        '–ü–ª–∞—Ç—Ñ–æ—Ä–º—ã –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã'
                    ],
                    'sources': [
                        '–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞',
                        '–°—Ç–∞–Ω–¥–∞—Ä—Ç—ã –∏ –Ω–æ—Ä–º–∞—Ç–∏–≤—ã',
                        '–û–ø—ã—Ç —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏',
                        '–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏—Å–ø—ã—Ç–∞–Ω–∏–π',
                        '–ú–µ—Ç–æ–¥–∏—á–µ—Å–∫–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã'
                    ]
                },
                'quality_metrics': {
                    'accuracy': '>95%',
                    'completeness': '>90%',
                    'relevance': '>90%',
                    'readability': '>85%',
                    'technical_depth': '—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —É—Ä–æ–≤–Ω—é —Å–ª–æ–∂–Ω–æ—Å—Ç–∏'
                },
                'created_date': datetime.now().isoformat()
            }
            
            # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            total_target = sum(cat['target_count'] for cat in expansion_plan['expansion_categories'])
            for category in expansion_plan['expansion_categories']:
                category['documents_to_add'] = max(0, category['target_count'] - category['current_count'])
            
            return expansion_plan
            
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞–Ω–∞: {e}")
            return {}
    
    def _get_category_count(self, category: str) -> int:
        """–ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"""
        try:
            cursor = self.connection.cursor()
            cursor.execute("SELECT COUNT(*) FROM documents WHERE category = ?", (category,))
            return cursor.fetchone()[0]
        except:
            return 0
    
    def create_document_templates(self) -> List[Dict[str, Any]]:
        """–°–æ–∑–¥–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è"""
        templates = [
            {
                'template_name': '–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ',
                'structure': {
                    'title': '–ù–∞–∑–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞',
                    'introduction': '–í–≤–µ–¥–µ–Ω–∏–µ –∏ –æ–±–ª–∞—Å—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è',
                    'theory': '–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã',
                    'practical': '–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∞—Å–ø–µ–∫—Ç—ã',
                    'examples': '–ü—Ä–∏–º–µ—Ä—ã –∏ –∫–µ–π—Å—ã',
                    'troubleshooting': '–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π',
                    'references': '–°—Å—ã–ª–∫–∏ –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞'
                },
                'target_categories': ['–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è', '—ç–ª–µ–∫—Ç—Ä–æ—Ç–µ—Ö–Ω–∏–∫–∞', '–º–µ—Ö–∞–Ω–∏–∫–∞']
            },
            {
                'template_name': '–ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ',
                'structure': {
                    'title': '–ù–∞–∑–≤–∞–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏/–º–æ–¥—É–ª—è',
                    'installation': '–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞',
                    'api_reference': '–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ API',
                    'examples': '–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è',
                    'best_practices': '–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é',
                    'troubleshooting': '–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º',
                    'changelog': '–ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π'
                },
                'target_categories': ['–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ', '–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ_—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏']
            },
            {
                'template_name': '–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã',
                'structure': {
                    'title': '–ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞/–ø—Ä–∞–≤–∏–ª–∞',
                    'scope': '–û–±–ª–∞—Å—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è',
                    'requirements': '–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ –Ω–æ—Ä–º—ã',
                    'implementation': '–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π',
                    'compliance': '–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º',
                    'audit': '–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∞—É–¥–∏—Ç',
                    'penalties': '–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∏ —à—Ç—Ä–∞—Ñ—ã'
                },
                'target_categories': ['–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å', '–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è', '—ç–ª–µ–∫—Ç—Ä–æ—Ç–µ—Ö–Ω–∏–∫–∞']
            },
            {
                'template_name': '–ù–∞—É—á–Ω–æ-—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Å—Ç–∞—Ç—å—è',
                'structure': {
                    'title': '–ù–∞–∑–≤–∞–Ω–∏–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è',
                    'abstract': '–ê–Ω–Ω–æ—Ç–∞—Ü–∏—è',
                    'introduction': '–í–≤–µ–¥–µ–Ω–∏–µ –∏ –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏',
                    'methodology': '–ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è',
                    'results': '–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –∞–Ω–∞–ª–∏–∑',
                    'discussion': '–û–±—Å—É–∂–¥–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤',
                    'conclusions': '–í—ã–≤–æ–¥—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏',
                    'references': '–°–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã'
                },
                'target_categories': ['—Ä–∞–¥–∏–æ—Ç–µ—Ö–Ω–∏–∫–∞', '–º–µ—Ö–∞–Ω–∏–∫–∞', '–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ_—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏']
            }
        ]
        
        return templates
    
    def generate_implementation_schedule(self) -> Dict[str, Any]:
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏"""
        schedule = {
            'week_1_2': {
                'tasks': [
                    '–ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö',
                    '–°–æ–∑–¥–∞–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø–ª–∞–Ω–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è',
                    '–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —à–∞–±–ª–æ–Ω–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤',
                    '–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã –∫–æ–Ω—Ç—Ä–æ–ª—è –∫–∞—á–µ—Å—Ç–≤–∞'
                ],
                'deliverables': [
                    '–ü–ª–∞–Ω —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö',
                    '–®–∞–±–ª–æ–Ω—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤',
                    '–ö—Ä–∏—Ç–µ—Ä–∏–∏ –∫–∞—á–µ—Å—Ç–≤–∞',
                    '–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞'
                ]
            },
            'week_3_6': {
                'tasks': [
                    '–°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ (25 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤)',
                    '–°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–æ —ç–ª–µ–∫—Ç—Ä–æ—Ç–µ—Ö–Ω–∏–∫–µ (20 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤)',
                    '–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏–Ω–æ–Ω–∏–º–æ–≤ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π',
                    '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –ø–æ–∏—Å–∫–∞'
                ],
                'deliverables': [
                    '45 –Ω–æ–≤—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤',
                    '–û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –±–∞–∑–∞ —Å–∏–Ω–æ–Ω–∏–º–æ–≤',
                    '–û—Ç—á–µ—Ç –æ –∫–∞—á–µ—Å—Ç–≤–µ –ø–æ–∏—Å–∫–∞',
                    '–ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏'
                ]
            },
            'week_7_10': {
                'tasks': [
                    '–°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—é (20 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤)',
                    '–°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–æ —Ä–∞–¥–∏–æ—Ç–µ—Ö–Ω–∏–∫–µ (15 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤)',
                    '–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏',
                    '–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏'
                ],
                'deliverables': [
                    '35 –Ω–æ–≤—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤',
                    '–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–æ–∏—Å–∫–∞',
                    '–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö',
                    '–û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è'
                ]
            },
            'week_11_14': {
                'tasks': [
                    '–°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–æ –º–µ—Ö–∞–Ω–∏–∫–µ (15 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤)',
                    '–°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–æ –ò–¢ (15 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤)',
                    '–°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (10 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤)',
                    '–§–∏–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è'
                ],
                'deliverables': [
                    '40 –Ω–æ–≤—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤',
                    '–ü–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞',
                    '–§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –æ –∫–∞—á–µ—Å—Ç–≤–µ',
                    '–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –¥–∞–ª—å–Ω–µ–π—à–µ–º—É —Ä–∞–∑–≤–∏—Ç–∏—é'
                ]
            },
            'milestones': [
                {'date': '–ù–µ–¥–µ–ª—è 2', 'milestone': '–ü–ª–∞–Ω –∏ —à–∞–±–ª–æ–Ω—ã –≥–æ—Ç–æ–≤—ã'},
                {'date': '–ù–µ–¥–µ–ª—è 6', 'milestone': '50% –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¥–æ–±–∞–≤–ª–µ–Ω–æ'},
                {'date': '–ù–µ–¥–µ–ª—è 10', 'milestone': '75% –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¥–æ–±–∞–≤–ª–µ–Ω–æ'},
                {'date': '–ù–µ–¥–µ–ª—è 14', 'milestone': '–¶–µ–ª—å 200+ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞'}
            ]
        }
        
        return schedule
    
    def save_plan_to_file(self, plan: Dict[str, Any], filename: str = "database_expansion_plan.json"):
        """–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–ª–∞–Ω–∞ –≤ —Ñ–∞–π–ª"""
        try:
            with open(filename, 'w', encoding='utf-8') as f:
                json.dump(plan, f, ensure_ascii=False, indent=2)
            print(f"‚úÖ –ü–ª–∞–Ω —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ —Ñ–∞–π–ª: {filename}")
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–ª–∞–Ω–∞: {e}")
    
    def close_connection(self):
        """–ó–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö"""
        if self.connection:
            self.connection.close()
            print("‚úÖ –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –ë–î –∑–∞–∫—Ä—ã—Ç–æ")

def main():
    """–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è"""
    print("üìà –ü–õ–ê–ù –†–ê–°–®–ò–†–ï–ù–ò–Ø –ë–ê–ó–´ –î–ê–ù–ù–´–• –î–û 200+ –î–û–ö–£–ú–ï–ù–¢–û–í")
    print("=" * 60)
    
    planner = DatabaseExpansionPlanner()
    
    try:
        # –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        print("\nüìä –ê–ù–ê–õ–ò–ó –¢–ï–ö–£–©–ï–ì–û –°–û–°–¢–û–Ø–ù–ò–Ø:")
        current_state = planner.analyze_current_state()
        print(f"  - –í—Å–µ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤: {current_state.get('total_documents', 0)}")
        print(f"  - –í—Å–µ–≥–æ —Å–∏–Ω–æ–Ω–∏–º–æ–≤: {current_state.get('total_synonyms', 0)}")
        print(f"  - –†–∞–∑–º–µ—Ä –ë–î: {current_state.get('database_size_mb', 0)} –ú–ë")
        
        print("\nüìã –ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:")
        for category in current_state.get('categories', []):
            print(f"    ‚Ä¢ {category['name']}: {category['count']} –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤")
        
        # –°–æ–∑–¥–∞–µ–º –ø–ª–∞–Ω —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
        print("\nüéØ –°–û–ó–î–ê–ù–ò–ï –ü–õ–ê–ù–ê –†–ê–°–®–ò–†–ï–ù–ò–Ø:")
        expansion_plan = planner.create_expansion_plan(target_documents=200)
        
        if expansion_plan.get('status') == 'goal_achieved':
            print("‚úÖ –¶–µ–ª—å —É–∂–µ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞!")
            return
        
        print(f"  - –¶–µ–ª–µ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ: {expansion_plan['target_documents']} –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤")
        print(f"  - –¢–µ–∫—É—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ: {expansion_plan['current_documents']} –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤")
        print(f"  - –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å: {expansion_plan['documents_needed']} –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤")
        
        print("\nüìö –ü–õ–ê–ù –ü–û –ö–ê–¢–ï–ì–û–†–ò–Ø–ú:")
        for category in expansion_plan['expansion_categories']:
            if category['documents_to_add'] > 0:
                print(f"  ‚Ä¢ {category['category']}: +{category['documents_to_add']} –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: {category['priority']})")
        
        # –°–æ–∑–¥–∞–µ–º —à–∞–±–ª–æ–Ω—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
        print("\nüìù –®–ê–ë–õ–û–ù–´ –î–û–ö–£–ú–ï–ù–¢–û–í:")
        templates = planner.create_document_templates()
        for template in templates:
            print(f"  ‚Ä¢ {template['template_name']} - –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π: {', '.join(template['target_categories'])}")
        
        # –°–æ–∑–¥–∞–µ–º –≥—Ä–∞—Ñ–∏–∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
        print("\nüìÖ –ì–†–ê–§–ò–ö –†–ï–ê–õ–ò–ó–ê–¶–ò–ò:")
        schedule = planner.generate_implementation_schedule()
        for period, details in schedule.items():
            if period != 'milestones':
                print(f"  {period.replace('_', ' ').title()}:")
                for task in details['tasks']:
                    print(f"    - {task}")
        
        print("\nüéØ –í–ï–•–ò –ü–†–û–ï–ö–¢–ê:")
        for milestone in schedule['milestones']:
            print(f"  ‚Ä¢ {milestone['date']}: {milestone['milestone']}")
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–ª–∞–Ω
        planner.save_plan_to_file(expansion_plan)
        
        print(f"\nüí° –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:")
        print("  1. –ù–∞—á–Ω–∏—Ç–µ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–π –≤—ã—Å–æ–∫–æ–≥–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞")
        print("  2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤")
        print("  3. –†–µ–≥—É–ª—è—Ä–Ω–æ —Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ –ø–æ–∏—Å–∫–∞")
        print("  4. –û–±–Ω–æ–≤–ª—è–π—Ç–µ —Å–∏–Ω–æ–Ω–∏–º—ã –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤")
        print("  5. –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã")
        
        print(f"\nüìÖ –ü–ª–∞–Ω —Å–æ–∑–¥–∞–Ω: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
        
    except Exception as e:
        print(f"‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: {e}")
    finally:
        planner.close_connection()

if __name__ == "__main__":
    main()

















