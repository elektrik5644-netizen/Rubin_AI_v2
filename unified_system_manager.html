<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéõÔ∏è Rubin AI v2 - Unified System Manager</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .system-health {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .health-score {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
        }

        .score-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            font-weight: bold;
            color: white;
            margin-right: 20px;
        }

        .score-excellent { background: #4CAF50; }
        .score-good { background: #8BC34A; }
        .score-warning { background: #FF9800; }
        .score-critical { background: #F44336; }

        .health-info h3 {
            font-size: 1.5em;
            margin-bottom: 10px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .stat-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }

        .servers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .server-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .server-card:hover {
            transform: translateY(-5px);
        }

        .server-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .server-name {
            font-size: 1.3em;
            font-weight: bold;
            color: #333;
        }

        .server-status {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
        }

        .status-online { background: #d4edda; color: #155724; }
        .status-offline { background: #f8d7da; color: #721c24; }
        .status-error { background: #fff3cd; color: #856404; }
        .status-timeout { background: #cce5ff; color: #004085; }

        .server-description {
            color: #666;
            margin-bottom: 15px;
        }

        .server-actions {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            transition: background-color 0.3s ease;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5a6fd8;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
        }

        .btn-warning {
            background: #ffc107;
            color: #212529;
        }

        .btn-warning:hover {
            background: #e0a800;
        }

        .system-actions {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .action-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .action-card:hover {
            background: #e9ecef;
        }

        .action-icon {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .capabilities {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .capabilities-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .capability-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
        }

        .capability-title {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 10px;
            color: #667eea;
        }

        .capability-list {
            list-style: none;
        }

        .capability-list li {
            padding: 5px 0;
            border-bottom: 1px solid #dee2e6;
        }

        .capability-list li:last-child {
            border-bottom: none;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #666;
        }

        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .success {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .servers-grid {
                grid-template-columns: 1fr;
            }
            
            .actions-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéõÔ∏è Rubin AI v2</h1>
            <p>Unified System Manager - –ï–¥–∏–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</p>
        </div>

        <div class="system-health" id="systemHealth">
            <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–∏—Å—Ç–µ–º—ã...</div>
        </div>

        <div class="system-actions">
            <h3>üöÄ –°–∏—Å—Ç–µ–º–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h3>
            <div class="actions-grid">
                <div class="action-card" onclick="checkAllServers()">
                    <div class="action-icon">üîç</div>
                    <div>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–µ—Ä—ã</div>
                </div>
                <div class="action-card" onclick="restartAllServers()">
                    <div class="action-icon">üîÑ</div>
                    <div>–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–µ—Ä—ã</div>
                </div>
                <div class="action-card" onclick="loadCapabilities()">
                    <div class="action-icon">‚ö°</div>
                    <div>–ü–æ–∫–∞–∑–∞—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</div>
                </div>
                <div class="action-card" onclick="refreshStatus()">
                    <div class="action-icon">üîÑ</div>
                    <div>–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å</div>
                </div>
            </div>
        </div>

        <div class="servers-grid" id="serversGrid">
            <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤...</div>
        </div>

        <div class="capabilities" id="capabilities" style="display: none;">
            <h3>‚ö° –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã</h3>
            <div class="capabilities-grid" id="capabilitiesGrid">
                <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π...</div>
            </div>
        </div>
    </div>

    <script>
        let systemData = null;

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–∏—Å—Ç–µ–º—ã
        async function loadSystemStatus() {
            try {
                const response = await fetch('/api/system/status');
                const data = await response.json();
                
                if (data.success) {
                    systemData = data;
                    displaySystemHealth(data.system_health);
                    displayServers(data.system_health.servers);
                } else {
                    showError('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ —Å–∏—Å—Ç–µ–º—ã: ' + data.error);
                }
            } catch (error) {
                showError('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ' + error.message);
            }
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã
        function displaySystemHealth(health) {
            const healthDiv = document.getElementById('systemHealth');
            
            const statusClass = `score-${health.status}`;
            const statusText = {
                'excellent': '–û—Ç–ª–∏—á–Ω–æ',
                'good': '–•–æ—Ä–æ—à–æ',
                'warning': '–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ',
                'critical': '–ö—Ä–∏—Ç–∏—á–Ω–æ'
            };
            
            healthDiv.innerHTML = `
                <div class="health-score">
                    <div class="score-circle ${statusClass}">
                        ${health.score}%
                    </div>
                    <div class="health-info">
                        <h3>${statusText[health.status]}</h3>
                        <p>–°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã: ${health.status}</p>
                        <p>–ü–æ—Å–ª–µ–¥–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞: ${new Date(health.timestamp).toLocaleString()}</p>
                    </div>
                </div>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number">${health.stats.total}</div>
                        <div>–í—Å–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–æ–≤</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" style="color: #28a745;">${health.stats.online}</div>
                        <div>–û–Ω–ª–∞–π–Ω</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" style="color: #dc3545;">${health.stats.offline}</div>
                        <div>–û—Ñ—Ñ–ª–∞–π–Ω</div>
                    </div>
                </div>
            `;
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–æ–≤
        function displayServers(servers) {
            const serversGrid = document.getElementById('serversGrid');
            
            let html = '';
            for (const [serverName, config] of Object.entries(servers)) {
                const statusClass = `status-${config.status}`;
                const statusText = {
                    'online': '–û–Ω–ª–∞–π–Ω',
                    'offline': '–û—Ñ—Ñ–ª–∞–π–Ω',
                    'error': '–û—à–∏–±–∫–∞',
                    'timeout': '–¢–∞–π–º–∞—É—Ç',
                    'unknown': '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'
                };
                
                html += `
                    <div class="server-card">
                        <div class="server-header">
                            <div class="server-name">${config.name}</div>
                            <div class="server-status ${statusClass}">${statusText[config.status]}</div>
                        </div>
                        <div class="server-description">${config.description}</div>
                        <div style="margin-bottom: 15px;">
                            <strong>–ü–æ—Ä—Ç:</strong> ${config.port}<br>
                            <strong>Endpoint:</strong> ${config.endpoint}
                            ${config.response_time ? `<br><strong>–í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞:</strong> ${(config.response_time * 1000).toFixed(0)}ms` : ''}
                        </div>
                        <div class="server-actions">
                            <button class="btn btn-primary" onclick="startServer('${serverName}')">–ó–∞–ø—É—Å—Ç–∏—Ç—å</button>
                            <button class="btn btn-success" onclick="checkServer('${serverName}')">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
                        </div>
                    </div>
                `;
            }
            
            serversGrid.innerHTML = html;
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤
        async function checkAllServers() {
            try {
                const response = await fetch('/api/system/check', { method: 'POST' });
                const data = await response.json();
                
                if (data.success) {
                    showSuccess('–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–∞');
                    displayServers(data.servers);
                } else {
                    showError('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–µ—Ä–≤–µ—Ä–æ–≤: ' + data.error);
                }
            } catch (error) {
                showError('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–µ—Ä–≤–µ—Ä–æ–≤: ' + error.message);
            }
        }

        // –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
        async function startServer(serverName) {
            try {
                const response = await fetch(`/api/system/start/${serverName}`, { method: 'POST' });
                const data = await response.json();
                
                if (data.success) {
                    showSuccess(`–°–µ—Ä–≤–µ—Ä ${serverName} –∑–∞–ø—É—â–µ–Ω: ${data.message}`);
                    setTimeout(loadSystemStatus, 2000);
                } else {
                    showError(`–û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ ${serverName}: ${data.message}`);
                }
            } catch (error) {
                showError('–û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞: ' + error.message);
            }
        }

        // –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤
        async function restartAllServers() {
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–µ—Ä—ã?')) {
                return;
            }
            
            try {
                const response = await fetch('/api/system/restart_all', { method: 'POST' });
                const data = await response.json();
                
                if (data.success) {
                    showSuccess('–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω');
                    setTimeout(loadSystemStatus, 5000);
                } else {
                    showError('–û—à–∏–±–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤: ' + data.error);
                }
            } catch (error) {
                showError('–û—à–∏–±–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤: ' + error.message);
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π
        async function loadCapabilities() {
            try {
                const response = await fetch('/api/system/capabilities');
                const data = await response.json();
                
                if (data.success) {
                    displayCapabilities(data.capabilities);
                    document.getElementById('capabilities').style.display = 'block';
                } else {
                    showError('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π: ' + data.error);
                }
            } catch (error) {
                showError('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π: ' + error.message);
            }
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π
        function displayCapabilities(capabilities) {
            const capabilitiesGrid = document.getElementById('capabilitiesGrid');
            
            let html = '';
            for (const [category, features] of Object.entries(capabilities)) {
                html += `
                    <div class="capability-card">
                        <div class="capability-title">${category}</div>
                        <ul class="capability-list">
                            ${features.map(feature => `<li>${feature}</li>`).join('')}
                        </ul>
                    </div>
                `;
            }
            
            capabilitiesGrid.innerHTML = html;
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
        function refreshStatus() {
            loadSystemStatus();
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É
        function showError(message) {
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error';
            errorDiv.textContent = message;
            document.querySelector('.container').insertBefore(errorDiv, document.querySelector('.system-health'));
            
            setTimeout(() => errorDiv.remove(), 5000);
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —É—Å–ø–µ—Ö
        function showSuccess(message) {
            const successDiv = document.createElement('div');
            successDiv.className = 'success';
            successDiv.textContent = message;
            document.querySelector('.container').insertBefore(successDiv, document.querySelector('.system-health'));
            
            setTimeout(() => successDiv.remove(), 3000);
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
        setInterval(loadSystemStatus, 30000);

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
        document.addEventListener('DOMContentLoaded', loadSystemStatus);
    </script>
</body>
</html>








