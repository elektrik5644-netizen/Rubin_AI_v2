# Архитектура Rubin AI v2 с LocalAI

## 🔄 Полный поток обработки запроса

```
┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│   Пользователь   │───▶│  Веб-интерфейс   │───▶│ Smart Dispatcher│
│                 │    │   (порт 8080)    │    │   (порт 8080)   │
└─────────────────┘    └──────────────────┘    └─────────────────┘
                                                         │
                                                         ▼
┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│   LocalAI       │◀───│  Специализированные │◀───│   Категоризация │
│  (порт 11434)   │    │     модули        │    │    запроса      │
└─────────────────┘    └──────────────────┘    └─────────────────┘
                              │
                              ▼
┌─────────────────┐    ┌──────────────────┐
│   Пользователь   │◀───│   Формирование   │
│                 │    │     ответа       │
└─────────────────┘    └──────────────────┘
```

## 📋 Детальный процесс

### 1. **Входная точка**
- **Веб-интерфейс**: `http://localhost:8080` (RubinIDE.html)
- **API**: `http://localhost:8080/api/chat`

### 2. **Smart Dispatcher (порт 8080)**
- Получает запрос от пользователя
- Анализирует ключевые слова
- Определяет категорию запроса
- Направляет к соответствующему модулю

### 3. **Специализированные модули**
- **Электротехника (8087)**: электрические схемы, расчеты
- **Радиомеханика (8089)**: радиочастоты, передатчики
- **Контроллеры (9000)**: PLC, ПИД-регуляторы
- **Математика (8086)**: вычисления, уравнения
- **Программирование (8088)**: код, алгоритмы
- **Общий сервер (8085)**: общие вопросы

### 4. **LocalAI (порт 11434)**
- Локальная генерация ответов
- OpenAI API совместимость
- Модели: gpt-3.5-turbo, gpt-4
- Fallback для сложных запросов

### 5. **Формирование ответа**
- Специализированный модуль обрабатывает запрос
- При необходимости обращается к LocalAI
- Формирует структурированный ответ
- Возвращает результат пользователю











